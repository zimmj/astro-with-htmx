---
import BaseLayout from '../layouts/BaseLayout.astro';
import Input from '../components/ui/Input.astro';
import Button from '../components/ui/Button.astro';
import Link from '../components/ui/Link.astro';

const { cookies } = Astro;

const accessToken = cookies.get('sb-access-token');
const refreshToken = cookies.get('sb-refresh-token');

if (accessToken && refreshToken) {
  return Astro.redirect('/dashboard');
}
---

<BaseLayout
  title="Sign In"
  description="Sign in to your Virtual Visual account"
  keywords="sign in, login, account"
>
  <main class="container mx-auto px-4 py-8">
    <div class="mb-8 text-center">
      <h1 class="mb-2 text-3xl font-bold">Sign In</h1>
      <p class="text-gray-600">
        Don't have an account?
        <Link href="/register">Register</Link>
      </p>
    </div>

    <div class="mx-auto max-w-md">
      <div id="form-alert-container" class="mb-4"></div>

      <form
        method="post"
        hx-post="/api/auth/signin"
        hx-target="#form-alert-container"
        hx-swap="innerHTML"
        class="space-y-6 rounded-lg border border-gray-200 bg-white p-8 shadow-lg"
      >
        <Input
          label="Email"
          type="email"
          name="email"
          id="email"
          required
          placeholder="you@example.com"
        />

        <Input
          label="Password"
          type="password"
          name="password"
          id="password"
          required
          placeholder="Your password"
        />

        <Button type="submit" fullWidth>Sign In</Button>
      </form>
    </div>
  </main>
</BaseLayout>
